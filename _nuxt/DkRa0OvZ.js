import{e as B,q as V,o as n,w as a,a as w,t as I,b as c,p as s,d as b,k as T,K as R,P as k,a6 as Q,c as y,O as C,a2 as F,I as Z,J as M,s as A,r as j,f as re,af as H,l as X}from"#entry";import{g as K,T as q,z as ne,aU as L,aV as P,q as J,aW as ce,aX as ie,l as ue,aY as de,aa as g,ac as Y,ab as pe,aZ as me,at as fe,a_ as he,i as ye,a$ as ve,b0 as be,t as G,ae as we,A as ee,b1 as xe,b2 as _e,b3 as ke,b4 as ge,b5 as Ve,b6 as Se,j as $e,C as Ue,ad as Ce,ag as Ae}from"./DBBIm6QW.js";const Oe={class:"text-c-2 mb-4 text-sm leading-normal"},ze={class:"flex justify-between gap-2"},te=B({__name:"DeleteRequestAuthModal",props:{state:{},scheme:{}},emits:["close","delete"],setup(l,{emit:U}){const f=l,h=U,{securitySchemeMutators:x}=K(),_=()=>{f.scheme?.id&&x.delete(f.scheme.id),h("delete")};return(o,p)=>(n(),V(s(ne),{size:"xxs",state:o.state,title:"Delete Security Scheme"},{default:a(()=>[w("p",Oe," This cannot be undone. You're about to delete the "+I(o.scheme?.label)+" security scheme from the collection. ",1),w("div",ze,[c(s(q),{class:"flex h-8 cursor-pointer items-center gap-1.5 px-3 shadow-none focus:outline-none",type:"button",variant:"outlined",onClick:p[0]||(p[0]=i=>h("close"))},{default:a(()=>p[1]||(p[1]=[b(" Cancel ")])),_:1,__:[1]}),c(s(q),{class:"flex h-8 cursor-pointer items-center gap-1.5 px-3 shadow-none focus:outline-none",type:"submit",onClick:_},{default:a(()=>[b(" Delete "+I(o.scheme?.label),1)]),_:1})])]),_:1},8,["state"]))}}),le=(l,U,f,{securitySchemeMutators:h,securitySchemes:x},_=!1)=>{if(h.edit(l,U,f),!!_)try{const o=JSON.parse(L().getItem(P.AUTH)??"{}"),p=x[l];if(o&&p?.nameKey){const i=o[p.nameKey]||={};i[U]=f,L().setItem(P.AUTH,JSON.stringify(o))}}catch(o){console.error(o)}},Ie=(l,U)=>{try{const{collectionMutators:f,securitySchemes:h,securitySchemeMutators:x}=l,_=JSON.parse(L().getItem(P.AUTH)??"{}"),o=Object.keys(h).reduce((i,t)=>{const e=h[t];return e&&(i[e.nameKey]=e.uid),i},{});Object.entries(_).forEach(([i,t])=>{const e=o[i];e&&Object.entries(t).forEach(([r,u])=>{x.edit(e,r,u)})});const p=JSON.parse(L().getItem(P.SELECTED_SECURITY_SCHEMES)??"[]").map(i=>Array.isArray(i)?i.map(t=>o[t]).filter(J):o[i]).filter(J);f.edit(U,"selectedSecuritySchemeUids",p)}catch(f){console.error(f)}},Te={class:"flex h-fit w-full"},Re={class:"flex-1"},qe={class:"flex items-center gap-1.75"},Be={class:"grid auto-rows-auto",style:{gridTemplateColumns:"1fr auto"}},Ee={key:0},je={class:"font-code text-xs"},Me=B({__name:"OAuthScopesInput",props:{flow:{},updateScheme:{type:Function}},setup(l){const U=T(()=>Object.entries(l.flow?.scopes??{}).map(([p,i])=>({id:p,label:p,description:i}))),f=T(()=>l.flow?.selectedScopes||[]);function h(p,i){i?l.updateScheme(`flows.${l.flow.type}.selectedScopes`,[...f.value,p]):l.updateScheme(`flows.${l.flow.type}.selectedScopes`,f.value.filter(t=>t!==p))}const x=T(()=>l.flow?.selectedScopes?.length===Object.keys(l.flow?.scopes??{}).length),_=()=>{l.updateScheme(`flows.${l.flow.type}.selectedScopes`,Object.keys(l.flow?.scopes??{}))},o=()=>{l.updateScheme(`flows.${l.flow.type}.selectedScopes`,[])};return(p,i)=>(n(),V(s(Y),{class:"h-auto !max-h-[initial] min-h-8 items-center"},{default:a(()=>[w("div",Te,[i[2]||(i[2]=w("div",{class:"text-c-1 h-full items-center"},null,-1)),c(s(ce),{as:"div",class:"bl flex w-full flex-col"},{default:a(()=>[c(s(ie),{class:R(["group/scopes-accordion hover:text-c-1 flex h-auto min-h-8 cursor-pointer items-center gap-1.5 pr-2.25 pl-3 text-left",(p.flow?.selectedScopes?.length||0)>0?"text-c-1":"text-c-3"])},{default:a(({open:t})=>[w("div",Re," Scopes Selected "+I(p.flow?.selectedScopes?.length||0)+" / "+I(Object.keys(p.flow?.scopes??{}).length||0),1),w("div",qe,[x.value?(n(),V(s(q),{key:0,class:"pr-0.75 pl-1 transition-none",size:"sm",variant:"ghost",onClick:Q(o,["stop"])},{default:a(()=>i[0]||(i[0]=[b(" Deselect All ")])),_:1,__:[0]})):k("",!0),x.value?k("",!0):(n(),V(s(q),{key:1,class:"pr-0.75 pl-1 transition-none",size:"sm",variant:"ghost",onClick:Q(_,["stop"])},{default:a(()=>i[1]||(i[1]=[b(" Select All ")])),_:1,__:[1]})),c(s(ue),{class:"text-c-3 group-hover/scopes-accordion:text-c-2",icon:t?"ChevronDown":"ChevronRight",size:"md"},null,8,["icon"])])]),_:1},8,["class"]),c(s(de),{as:"template"},{default:a(()=>[w("table",Be,[(n(!0),y(C,null,F(U.value,({id:t,label:e,description:r})=>(n(),V(s(g),{key:t,class:"text-c-2",onClick:u=>h(t,!f.value.includes(t))},{default:a(()=>[c(s(Y),{class:"hover:text-c-1 box-border !max-h-[initial] w-full cursor-pointer px-3 py-1.5"},{default:a(()=>[r?(n(),y("div",Ee,[w("span",je,I(e),1),b(" â€“ "+I(r),1)])):k("",!0)]),_:2},1024),c(s(pe),{modelValue:f.value.includes(t),"onUpdate:modelValue":()=>{}},null,8,["modelValue"])]),_:2},1032,["onClick"]))),128))])]),_:1})]),_:1})])]),_:1}))}}),De=["for"],z=B({__name:"RequestAuthDataTableInput",props:{type:{},containerClass:{},required:{type:Boolean,default:!1},modelValue:{},readOnly:{type:Boolean,default:!1},environment:{},envVariables:{},workspace:{}},emits:["update:modelValue","inputFocus","inputBlur","selectVariable"],setup(l,{emit:U}){const f=l,h=U,x=Z();return(_,o)=>(n(),V(me,A({id:s(x),canAddCustomEnumValue:!f.readOnly,containerClass:f.containerClass},_.$attrs,{envVariables:f.envVariables,environment:f.environment,lineWrapping:"",modelValue:f.modelValue,readOnly:f.readOnly,required:f.required,type:f.type,workspace:f.workspace,onInputBlur:o[0]||(o[0]=p=>h("inputBlur")),onInputFocus:o[1]||(o[1]=p=>h("inputFocus")),onSelectVariable:o[2]||(o[2]=p=>h("selectVariable",p)),"onUpdate:modelValue":o[3]||(o[3]=p=>h("update:modelValue",p))}),{default:a(()=>[w("label",{for:s(x)},[M(_.$slots,"default")],8,De)]),icon:a(()=>[M(_.$slots,"icon")]),_:3},16,["id","canAddCustomEnumValue","containerClass","envVariables","environment","modelValue","readOnly","required","type","workspace"]))}}),Fe={class:"flex h-8 items-center justify-end border-t"},Le={class:"flex h-8 w-full items-center justify-end border-t"},Pe=B({__name:"OAuth2",props:{collection:{},environment:{},envVariables:{},flow:{},persistAuth:{type:Boolean,default:!1},scheme:{},server:{},workspace:{}},emits:["authorized"],setup(l,{emit:U}){const f=U,h=fe(),{toast:x}=ye(),_=K(),o=(t,e)=>le(l.scheme.uid,t,e,_,l.persistAuth),p=async()=>{if(h.isLoading||!l.collection?.uid)return;if(!l.server){x("No server selected","error");return}h.startLoading();const[t,e]=await ve(l.flow,l.server,l.workspace?.proxyUrl).finally(()=>h.stopLoading());e?(o(`flows.${l.flow.type}.token`,e),f("authorized")):(console.error(t),x(t?.message??"Failed to authorize","error"))},i={environment:l.environment,envVariables:l.envVariables,workspace:l.workspace};return(t,e)=>(n(),y(C,null,[t.flow.token?(n(),y(C,{key:0},[c(s(g),null,{default:a(()=>[c(z,A(i,{class:"border-r-transparent",modelValue:t.flow.token,placeholder:"QUxMIFlPVVIgQkFTRSBBUkUgQkVMT05HIFRPIFVT",type:"password","onUpdate:modelValue":e[0]||(e[0]=r=>o(`flows.${t.flow.type}.token`,r))}),{default:a(()=>e[10]||(e[10]=[b(" Access Token ")])),_:1,__:[10]},16,["modelValue"])]),_:1}),c(s(g),{class:"min-w-full"},{default:a(()=>[w("div",Fe,[c(s(q),{class:"mr-1 p-0 px-2 py-0.5",loading:s(h),size:"sm",variant:"outlined",onClick:e[1]||(e[1]=r=>o(`flows.${t.flow.type}.token`,""))},{default:a(()=>e[11]||(e[11]=[b(" Clear ")])),_:1,__:[11]},8,["loading"]),M(t.$slots,"oauth-actions")])]),_:3})],64)):(n(),y(C,{key:1},[c(s(g),null,{default:a(()=>["authorizationUrl"in t.flow?(n(),V(z,A({key:0},i,{containerClass:"border-r-0",modelValue:t.flow.authorizationUrl,placeholder:"https://galaxy.scalar.com/authorize","onUpdate:modelValue":e[2]||(e[2]=r=>o(`flows.${t.flow.type}.authorizationUrl`,r))}),{default:a(()=>e[12]||(e[12]=[b(" Auth URL ")])),_:1,__:[12]},16,["modelValue"])):k("",!0),"tokenUrl"in t.flow?(n(),V(z,A({key:1},i,{modelValue:t.flow.tokenUrl,placeholder:"https://galaxy.scalar.com/token","onUpdate:modelValue":e[3]||(e[3]=r=>o(`flows.${t.flow.type}.tokenUrl`,r))}),{default:a(()=>e[13]||(e[13]=[b(" Token URL ")])),_:1,__:[13]},16,["modelValue"])):k("",!0)]),_:1}),"x-scalar-redirect-uri"in t.flow?(n(),V(s(g),{key:0},{default:a(()=>[c(z,A(i,{modelValue:t.flow["x-scalar-redirect-uri"],placeholder:"https://galaxy.scalar.com/callback","onUpdate:modelValue":e[4]||(e[4]=r=>o(`flows.${t.flow.type}.x-scalar-redirect-uri`,r))}),{default:a(()=>e[14]||(e[14]=[b(" Redirect URL ")])),_:1,__:[14]},16,["modelValue"])]),_:1})):k("",!0),t.flow.type==="password"?(n(),y(C,{key:1},[c(s(g),null,{default:a(()=>[c(z,A(i,{class:"text-c-2",modelValue:t.flow.username,placeholder:"janedoe","onUpdate:modelValue":e[5]||(e[5]=r=>o(`flows.${t.flow.type}.username`,r))}),{default:a(()=>e[15]||(e[15]=[b(" Username ")])),_:1,__:[15]},16,["modelValue"])]),_:1}),c(s(g),null,{default:a(()=>[c(z,A(i,{modelValue:t.flow.password,placeholder:"********",type:"password","onUpdate:modelValue":e[6]||(e[6]=r=>o(`flows.${t.flow.type}.password`,r))}),{default:a(()=>e[16]||(e[16]=[b(" Password ")])),_:1,__:[16]},16,["modelValue"])]),_:1})],64)):k("",!0),c(s(g),null,{default:a(()=>[c(z,A(i,{modelValue:t.flow["x-scalar-client-id"],placeholder:"12345","onUpdate:modelValue":e[7]||(e[7]=r=>o(`flows.${t.flow.type}.x-scalar-client-id`,r))}),{default:a(()=>e[17]||(e[17]=[b(" Client ID ")])),_:1,__:[17]},16,["modelValue"])]),_:1}),"clientSecret"in t.flow?(n(),V(s(g),{key:2},{default:a(()=>[c(z,A(i,{modelValue:t.flow.clientSecret,placeholder:"XYZ123",type:"password","onUpdate:modelValue":e[8]||(e[8]=r=>o(`flows.${t.flow.type}.clientSecret`,r))}),{default:a(()=>e[18]||(e[18]=[b(" Client Secret ")])),_:1,__:[18]},16,["modelValue"])]),_:1})):k("",!0),"x-usePkce"in t.flow?(n(),V(s(g),{key:3},{default:a(()=>[c(z,A(i,{enum:s(he),modelValue:t.flow["x-usePkce"],readOnly:"","onUpdate:modelValue":e[9]||(e[9]=r=>o(`flows.${t.flow.type}.x-usePkce`,r))}),{default:a(()=>e[19]||(e[19]=[b(" Use PKCE ")])),_:1,__:[19]},16,["enum","modelValue"])]),_:1})):k("",!0),Object.keys(t.flow.scopes??{}).length?(n(),V(s(g),{key:4},{default:a(()=>[c(Me,{flow:t.flow,updateScheme:o},null,8,["flow"])]),_:1})):k("",!0)],64)),t.flow.token?k("",!0):(n(),V(s(g),{key:2,class:"min-w-full"},{default:a(()=>[w("div",Le,[c(s(q),{class:"mr-0.75 p-0 px-2 py-0.5",loading:s(h),size:"sm",variant:"outlined",onClick:p},{default:a(()=>e[20]||(e[20]=[b(" Authorize ")])),_:1,__:[20]},8,["loading"])])]),_:1}))],64))}}),Ke={class:"bg-b-1 text-c-2 outline-b-3 top-0 z-1 h-full w-full overflow-hidden px-3 py-1.25 text-ellipsis group-hover/auth:absolute group-hover/auth:h-auto group-hover/auth:border-b *:first:line-clamp-1 *:first:text-ellipsis group-hover/auth:*:first:line-clamp-none"},Ne={key:0,class:"flex min-h-8 border-t text-base"},He={class:"flex h-8 max-w-full gap-2.5 overflow-x-auto px-3"},Qe=["onClick"],Je={class:"relative z-10"},Ye=B({__name:"RequestAuthTab",props:{collection:{},environment:{},envVariables:{},layout:{},persistAuth:{type:Boolean,default:!1},securitySchemeUids:{},server:{},workspace:{}},emits:["authorized"],setup(l,{emit:U}){const f=U,h=K(),{securitySchemes:x}=h,_=T(()=>l.securitySchemeUids.map(e=>({scheme:x[e]}))),o=j(""),p=e=>{const r=e.description?`: ${e.description}`:"",u=`${H(e.nameKey)}${r||`: ${e.type}`}`;if(e.type==="apiKey")return`${H(e.nameKey)}${r||`: ${e.in}`}`;if(e.type==="oauth2"){const S=Object.values(e.flows??{})[0];return`${H(e.nameKey)}: ${o.value?o.value:S?.type??""}${r}`}return e.type==="http"?`${H(e.nameKey)}: ${e.scheme}${r}`:`${u}${r}`},i=(e,r,u)=>{le(e,r,u,h,l.persistAuth)};re(()=>{l.persistAuth&&Ie(h,l.collection.uid)});const t={environment:l.environment,envVariables:l.envVariables,workspace:l.workspace};return(e,r)=>(n(!0),y(C,null,F(_.value,({scheme:u})=>(n(),y(C,{key:u?.uid},[_.value.length>1&&u?(n(),V(s(g),{key:0},{default:a(()=>[c(s(Y),{"aria-label":p(u),class:"text-c-2 group/auth flex items-center leading-[22px] whitespace-nowrap outline-none hover:whitespace-normal"},{default:a(()=>[w("p",Ke,I(p(u)),1)]),_:2},1032,["aria-label"])]),_:2},1024)):k("",!0),u?.description&&_.value.length<=1?(n(),V(s(g),{key:1},{default:a(()=>[c(s(Y),{"aria-label":u.description,class:"max-h-[auto]"},{default:a(()=>[c(s(be),{class:"auth-description bg-b-1 text-c-2 min-w-0 flex-1 px-3 py-1.25",value:u.description},null,8,["value"])]),_:2},1032,["aria-label"])]),_:2},1024)):k("",!0),u?.type==="http"?(n(),y(C,{key:2},[u.scheme==="bearer"?(n(),V(s(g),{key:0},{default:a(()=>[c(z,A({ref_for:!0},t,{containerClass:e.layout==="reference"&&"border-t",modelValue:u.token,placeholder:"Token",type:"password","onUpdate:modelValue":S=>i(u.uid,"token",S)}),{default:a(()=>r[1]||(r[1]=[b(" Bearer Token ")])),_:2,__:[1]},1040,["containerClass","modelValue","onUpdate:modelValue"])]),_:2},1024)):u?.scheme==="basic"?(n(),y(C,{key:1},[c(s(g),null,{default:a(()=>[c(z,A({ref_for:!0},t,{class:"text-c-2",modelValue:u.username,placeholder:"janedoe",required:"","onUpdate:modelValue":S=>i(u.uid,"username",S)}),{default:a(()=>r[2]||(r[2]=[b(" Username ")])),_:2,__:[2]},1040,["modelValue","onUpdate:modelValue"])]),_:2},1024),c(s(g),null,{default:a(()=>[c(z,A({ref_for:!0},t,{modelValue:u.password,placeholder:"********",type:"password","onUpdate:modelValue":S=>i(u.uid,"password",S)}),{default:a(()=>r[3]||(r[3]=[b(" Password ")])),_:2,__:[3]},1040,["modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):k("",!0)],64)):u?.type==="apiKey"?(n(),y(C,{key:3},[c(s(g),null,{default:a(()=>[c(z,A({ref_for:!0},t,{containerClass:e.layout==="reference"&&"border-t",modelValue:u.name,placeholder:"api-key","onUpdate:modelValue":S=>i(u.uid,"name",S)}),{default:a(()=>r[4]||(r[4]=[b(" Name ")])),_:2,__:[4]},1040,["containerClass","modelValue","onUpdate:modelValue"])]),_:2},1024),c(s(g),null,{default:a(()=>[c(z,A({ref_for:!0},t,{modelValue:u.value,placeholder:"QUxMIFlPVVIgQkFTRSBBUkUgQkVMT05HIFRPIFVT",type:"password","onUpdate:modelValue":S=>i(u.uid,"value",S)}),{default:a(()=>r[5]||(r[5]=[b(" Value ")])),_:2,__:[5]},1040,["modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):u?.type==="oauth2"?(n(),y(C,{key:4},[c(s(g),null,{default:a(()=>[Object.keys(u.flows).length>1?(n(),y("div",Ne,[w("div",He,[(n(!0),y(C,null,F(u?.flows,(S,O,E)=>(n(),y("button",{key:O,class:R(["floating-bg text-c-3 relative cursor-pointer border-b-[1px] border-transparent py-1 text-base font-medium",{"!text-c-1 !rounded-none border-b-[1px] !border-current":e.layout!=="reference"&&(o.value===O||E===0&&!o.value),"!text-c-1 !rounded-none border-b-[1px] !border-current opacity-100":e.layout==="reference"&&(o.value===O||E===0&&!o.value)}]),type:"button",onClick:N=>o.value=O},[w("span",Je,I(O),1)],10,Qe))),128))])])):k("",!0)]),_:2},1024),(n(!0),y(C,null,F(u?.flows,(S,O,E)=>(n(),y(C,{key:O},[o.value===O||E===0&&!o.value?(n(),V(Pe,A({key:0,ref_for:!0},t,{collection:e.collection,flow:S,persistAuth:e.persistAuth,scheme:u,server:e.server,workspace:e.workspace,onAuthorized:r[0]||(r[0]=N=>f("authorized"))}),{"oauth-actions":a(()=>[M(e.$slots,"oauth-actions")]),_:2},1040,["collection","flow","persistAuth","scheme","server","workspace"])):k("",!0)],64))),128))],64)):u?.type==="openIdConnect"?(n(),y("div",{key:5,class:R(["text-c-3 bg-b-1 flex min-h-[calc(4rem+1px)] items-center justify-center border-t border-b-0 px-4 text-base",{"rounded-b-lg":e.layout==="reference"}])}," Coming soon ",2)):k("",!0)],64))),128))}}),We=["onClick"],Xe={class:"relative z-10 font-medium whitespace-nowrap"},Ze={key:0,class:"absolute inset-x-1 bottom-[var(--scalar-border-width)] left-1/2 z-1 h-px w-full -translate-x-1/2 bg-current"},Ge=B({__name:"RequestAuthDataTable",props:{collection:{},environment:{},envVariables:{},layout:{default:"client"},persistAuth:{type:Boolean,default:!1},selectedSchemeOptions:{default:()=>[]},server:{},workspace:{}},emits:["authorized","activeSchemes"],setup(l,{emit:U}){const f=U,{securitySchemes:h}=K(),x=G(),_=j(null),o=j(0),p=T(()=>{if(!l.selectedSchemeOptions||l.selectedSchemeOptions.length===0)return[];const t=l.selectedSchemeOptions[o.value];if(!t)return[];const e=t.id.split(",").filter(Boolean);return e.length>1?e:[t.id]});X(p,t=>{f("activeSchemes",t.map(e=>h[e]).filter(J))},{immediate:!0});const i=T(()=>p.value.length>0);return X(()=>l.selectedSchemeOptions,t=>{(!t||!t[o.value])&&(o.value=Math.max(0,o.value-1))}),(t,e)=>(n(),y("form",{onSubmit:e[2]||(e[2]=Q(()=>{},["prevent"]))},[t.selectedSchemeOptions.length>1?(n(),y("div",{key:0,class:R(["box-content flex flex-wrap gap-x-2.5 overflow-hidden border border-b-0 px-3",t.layout==="client"&&"border-x-0"])},[(n(!0),y(C,null,F(t.selectedSchemeOptions,(r,u)=>(n(),y("div",{key:r.id,class:R(["relative z-1 -mb-[var(--scalar-border-width)] flex h-8 cursor-pointer",[o.value===u?"text-c-1":"text-c-3"]])},[w("button",{class:"floating-bg relative cursor-pointer border-b-[1px] border-transparent py-1 text-sm font-medium",type:"button",onClick:S=>o.value=u},[w("span",Xe,I(r.label),1)],8,We),o.value===u?(n(),y("div",Ze)):k("",!0)],2))),128))],2)):k("",!0),i.value?(n(),V(s(we),{key:1,class:R(["flex-1",t.layout==="reference"&&"bg-b-1 rounded-b-lg border border-t-0"]),columns:[""],presentational:""},{default:a(()=>[c(Ye,{collection:t.collection,envVariables:t.envVariables,environment:t.environment,layout:t.layout,persistAuth:t.persistAuth,securitySchemeUids:p.value,server:t.server,workspace:t.workspace,onAuthorized:e[0]||(e[0]=r=>f("authorized"))},{"oauth-actions":a(()=>[M(t.$slots,"oauth-actions",{},void 0,!0)]),_:3},8,["collection","envVariables","environment","layout","persistAuth","securitySchemeUids","server","workspace"])]),_:3},8,["class"])):(n(),y("div",{key:2,class:R(["text-c-3 bg-b-1 flex min-h-16 items-center justify-center border-t px-4 text-sm",t.layout==="reference"&&"min-h-[calc(4rem+0.5px)] rounded-b-lg border"])}," No authentication selected ",2)),c(te,{scheme:_.value,state:s(x),onClose:e[1]||(e[1]=r=>s(x).hide())},null,8,["scheme","state"])],32))}}),et=ee(Ge,[["__scopeId","data-v-0bb98074"]]),tt=["id"],lt={class:"flex flex-1"},at={class:"min-w-0 flex-1 truncate"},ot=B({__name:"RequestAuth",props:{collection:{},isReadOnly:{type:Boolean,default:!1},environment:{},envVariables:{},layout:{},operation:{},persistAuth:{type:Boolean,default:!1},selectedSecuritySchemeUids:{},server:{},title:{},workspace:{}},emits:["authorized","activeSchemes"],setup(l,{emit:U}){const f=U,{securitySchemes:h,securitySchemeMutators:x,requestMutators:_,collectionMutators:o}=K(),p=Z(),i=j(null),t=G(),e=j(null),r=j(!1),u=T(()=>{const m=xe(l.operation,l.collection);return{filteredRequirements:m.filter(d=>Object.keys(d).length),requirements:m}}),S=T(()=>{const{filteredRequirements:m,requirements:d}=u.value;if(!d.length)return null;const v=!d.some($=>Object.keys($).length>1)&&m.length<d.length;return{icon:v?"Unlock":"Lock",text:v?"Optional":"Required"}}),O=T(()=>l.selectedSecuritySchemeUids.map(m=>{if(Array.isArray(m))return _e(m,h);const d=h[m??""];if(d)return ke(d)}).filter(J));function E(m){const d=m.find($=>$.payload),v=m.filter($=>!$.payload).map(({id:$})=>{const D=$.split(",");return D.length>1?D:$});if(d?.payload){const $=x.add(d.payload,l.collection?.uid);$&&v.push($.uid)}N(v)}const N=m=>{if(l.collection.useCollectionSecurity){if(o.edit(l.collection.uid,"selectedSecuritySchemeUids",m),!l.persistAuth)return;const d=m.map(v=>Array.isArray(v)?v.map($=>h[$]?.nameKey):h[v]?.nameKey);L().setItem(P.SELECTED_SECURITY_SCHEMES,JSON.stringify(d))}else l.operation?.uid&&_.edit(l.operation.uid,"selectedSecuritySchemeUids",m)};function W({id:m,label:d}){e.value={id:m,label:d},t.show()}const ae=m=>{if(!m)return;const d=l.selectedSecuritySchemeUids.filter(v=>{const $=m.split(",");return $.length>1&&Array.isArray(v)&&$.length===v.length?v.every(D=>!$.includes(D)):v!==m});N(d),i.value?.$el.focus(),t.hide()},oe=T(()=>ge(u.value.filteredRequirements,l.collection?.securitySchemes??[],h,l.isReadOnly)),se=m=>{r.value&&m.stopPropagation(),i.value?.$el.click()};return(m,d)=>(n(),V(Ae,{class:"group/params relative",itemCount:O.value.length,layout:m.layout,"onUpdate:modelValue":d[4]||(d[4]=v=>r.value=v)},{title:a(()=>[w("div",{id:s(p),class:"inline-flex items-center gap-0.5 leading-[20px]"},[w("span",null,I(m.title),1),S.value?(n(),y("span",{key:0,class:R(["text-c-3 hover:bg-b-3 hover:text-c-1 -mr-1 cursor-pointer rounded px-1 py-0.5 text-xs leading-[normal]",{"text-c-1":S.value.text==="Required"}]),onClick:se},I(S.value.text),3)):k("",!0)],8,tt)]),actions:a(()=>[w("div",lt,[c(s(Ve),{class:"w-72 text-xs",modelValue:O.value,multiple:"",options:oe.value,placement:"bottom-end",teleport:"",onDelete:W,"onUpdate:modelValue":E},{option:a(({option:v,selected:$})=>[c(s($e),{multiselect:"",selected:$},null,8,["selected"]),w("div",at,I(v.label),1),v.isDeletable??!m.isReadOnly?(n(),V(s(Ue),{key:0,class:"-m-0.5 shrink-0 p-0.5 opacity-0 group-hover/item:opacity-100",icon:s(Ce),label:`Delete ${v.label}`,size:"xs",onClick:Q(D=>W(v),["stop"])},null,8,["icon","label","onClick"])):k("",!0)]),default:a(()=>[c(s(q),{ref_key:"comboboxButtonRef",ref:i,"aria-describedby":s(p),class:"group/combobox-button hover:text-c-1 text-c-2 flex h-fit w-full items-center gap-1 px-0.75 py-0.25 text-base font-normal transition-transform",variant:"ghost"},{default:a(()=>[O.value.length===1?(n(),y(C,{key:0},[d[5]||(d[5]=w("span",{class:"sr-only"},"Selected Auth Type:",-1)),b(" "+I(O.value[0]?.label),1)],64)):O.value.length>1?(n(),y(C,{key:1},[d[6]||(d[6]=b(" Multiple ")),d[7]||(d[7]=w("span",{class:"sr-only"},"Auth Types Selected",-1))],64)):(n(),y(C,{key:2},[d[8]||(d[8]=w("span",{class:"sr-only"},"Select",-1)),d[9]||(d[9]=b(" Auth Type "))],64)),c(s(Se),{class:"size-3 shrink-0 transition-transform duration-100 group-aria-expanded/combobox-button:rotate-180",weight:"bold"})]),_:1},8,["aria-describedby"])]),_:1},8,["modelValue","options"])])]),default:a(()=>[c(et,{collection:m.collection,envVariables:m.envVariables,environment:m.environment,layout:m.layout,persistAuth:m.persistAuth,selectedSchemeOptions:O.value,server:m.server,workspace:m.workspace,onActiveSchemes:d[0]||(d[0]=v=>f("activeSchemes",v)),onAuthorized:d[1]||(d[1]=v=>f("authorized"))},{"oauth-actions":a(()=>[M(m.$slots,"oauth-actions",{},void 0,!0)]),_:3},8,["collection","envVariables","environment","layout","persistAuth","selectedSchemeOptions","server","workspace"]),c(te,{scheme:e.value,state:s(t),onClose:d[2]||(d[2]=v=>s(t).hide()),onDelete:d[3]||(d[3]=v=>ae(e.value?.id))},null,8,["scheme","state"])]),_:3},8,["itemCount","layout"]))}}),nt=ee(ot,[["__scopeId","data-v-3f1067a4"]]);export{nt as f};
